extends codetemplatebase

block title
    title #{operation.key} - #{namespace}

block maincontent
    script.
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var target = $(e.target).attr("href") // activated tab
            alert(target);
        });

    +heading("Operation", operation.key, namespace, documentation) 

    hr

    H3 Request
    - var s = JSON.stringify(method)

    div(id="exTab1" class="container")
        ul(class="nav nav-pills")
            li(class="active")
                a(href="#1a" data-toggle="tab") Request
            li
                a(href="#2a" data-toggle="tab") Python
            li
                a(href="#3a" data-toggle="tab") Java
            li
                a(href="#4a" data-toggle="tab") C#
            li
                a(href="#4a" data-toggle="tab") Ruby
            li
                a(href="#4a" data-toggle="tab") JavaScript

        div(class="tab-content clearfix col-md-9")
            div(class="tab-pane active" id="1a")
                figure(class="code-listing") 
                    strong #{method.method}
                    |  #{method.path}
            div(class="tab-pane" id="2a")
                figure(class="code-listing")
                    span(class="language-python" id="python")
                - var re = /\./g
                - var path = namespace.replace(re, '/')
                script.
                    $('#python').load(`https://raw.githubusercontent.com/strefethen/samples/master/#{path}/#{operation.key}.py`, function() {
                        Prism.highlightAll();
                    });
            div(class="tab-pane" id="3a")
                script(src="https://gist.github.com/strefethen/730ac442e147a3ecd1e9.js")
            div(class="tab-pane" id="4a")

    +descriptionList(params, parameters)

    if Object.keys(output).length > 0
        h3 Output
        p !{output.documentation}
        - var x = JSON.stringify(output)
        - var t = JSON.stringify(output.type)
        h4 Type
        p #{t}
        p #{x}

    if Object.keys(errors).length > 0
        h3 Errors
            - var x = JSON.stringify(errors)
        table(class="table table-striped")
            tr
                th Type
                th Description
            each error in errors
                tr
                    - var f = `/structures/${error.structure_id}.html`
                    - var id = error.structure_id.split('.')
                    - id = id[id.length - 1]
                    td 
                        a(href=`${f}`) #{id}
                    td !{error.documentation}

    a(href='../index.html') Back

block sidebar
    +sidebaritems("Related Operations", operations, operation)

block lastjavascript
    script(src="/js/ghembedder.js" type="text/javascript")

    script.
        // somewhere after/during DOMReady
        ghe.autoload(); // requires browser to have EITHER document.querySelectorAll OR jquery 
